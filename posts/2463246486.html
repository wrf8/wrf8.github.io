<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Swift学习笔记 --- 协议 | Rui</title>
  <meta name="keywords" content="">
  <meta name="description" content="Swift学习笔记 --- 协议 | Rui">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="Oops～，我崩溃了！找不到你想要的页面 :(">
<meta property="og:type" content="website">
<meta property="og:title" content="404">
<meta property="og:url" content="https://wrf8.github.io/404.html">
<meta property="og:site_name" content="Rui">
<meta property="og:description" content="Oops～，我崩溃了！找不到你想要的页面 :(">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-03T02:27:27.000Z">
<meta property="article:modified_time" content="2021-03-03T02:57:22.568Z">
<meta property="article:author" content="Rui">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

  <link rel="stylesheet" type="text/css" href="/css/matery.css">
<meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
>
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Rui</span>
</div>

<div class="icon">
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="全部笔记">全部笔记
            
                <small>(41)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="iOS">
                        <i class="fold iconfont icon-right"></i>
                        
                        iOS
                        <small>(28)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="iOS<--->iOS-优化篇">
                                        
                                        iOS-优化篇
                                        
                                            <small>(1)</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="iOS<--->Swift-学习笔记">
                                        
                                        Swift-学习笔记
                                        
                                            <small>(27)</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="工具">
                        <i class="fold iconfont icon-right"></i>
                        
                        工具
                        <small>(13)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="工具<--->CocoaPods">
                                        
                                        CocoaPods
                                        
                                            <small>(1)</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="工具<--->Git">
                                        
                                        Git
                                        
                                            <small>(4)</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="工具<--->Hexo">
                                        
                                        Hexo
                                        
                                            <small>(6)</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="工具<--->Jenkins">
                                        
                                        Jenkins
                                        
                                            <small>(2)</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="41">
<input type="hidden" id="yelog_site_word_count" value="88.7k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="/null">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部笔记</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Jenkins</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a  class="全部笔记 iOS iOS-优化篇 "
           href="/posts/4187382084.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="iOS优化 --- IPA包大小优化">iOS优化 --- IPA包大小优化</span>
            <span class="post-date" title="2021-04-06 21:04:36">2021/04/06</span>
        </a>
        
        <a  class="全部笔记 工具 CocoaPods "
           href="/posts/206885443.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CocoaPods --- 安装和使用">CocoaPods --- 安装和使用</span>
            <span class="post-date" title="2021-04-01 22:20:56">2021/04/01</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/620084014.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 高级运算符">Swift学习笔记 --- 高级运算符</span>
            <span class="post-date" title="2021-03-31 22:40:07">2021/03/31</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/4250655424.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 访问控制">Swift学习笔记 --- 访问控制</span>
            <span class="post-date" title="2021-03-30 22:39:53">2021/03/30</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1374244109.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 内存安全">Swift学习笔记 --- 内存安全</span>
            <span class="post-date" title="2021-03-29 22:37:05">2021/03/29</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3594445199.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 自动引用计数">Swift学习笔记 --- 自动引用计数</span>
            <span class="post-date" title="2021-03-29 22:36:38">2021/03/29</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3146898703.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 不透明类型">Swift学习笔记 --- 不透明类型</span>
            <span class="post-date" title="2021-03-28 20:54:11">2021/03/28</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1236725232.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 泛型">Swift学习笔记 --- 泛型</span>
            <span class="post-date" title="2021-03-28 20:52:32">2021/03/28</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/2463246486.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 协议">Swift学习笔记 --- 协议</span>
            <span class="post-date" title="2021-03-28 17:11:37">2021/03/28</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/269908211.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 扩展">Swift学习笔记 --- 扩展</span>
            <span class="post-date" title="2021-03-28 01:32:10">2021/03/28</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3352431388.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 嵌套类型">Swift学习笔记 --- 嵌套类型</span>
            <span class="post-date" title="2021-03-28 01:19:58">2021/03/28</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/2981466500.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 类型转换">Swift学习笔记 --- 类型转换</span>
            <span class="post-date" title="2021-03-27 23:37:44">2021/03/27</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/293116127.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 错误处理">Swift学习笔记 --- 错误处理</span>
            <span class="post-date" title="2021-03-27 23:34:36">2021/03/27</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3859367755.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 可选链">Swift学习笔记 --- 可选链</span>
            <span class="post-date" title="2021-03-27 21:28:52">2021/03/27</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3783019282.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 析构过程">Swift学习笔记 --- 析构过程</span>
            <span class="post-date" title="2021-03-27 21:13:42">2021/03/27</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1111727047.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 构造过程">Swift学习笔记 --- 构造过程</span>
            <span class="post-date" title="2021-03-26 20:28:51">2021/03/26</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/773258487.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 继承">Swift学习笔记 --- 继承</span>
            <span class="post-date" title="2021-03-25 23:12:47">2021/03/25</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1770177402.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 下标">Swift学习笔记 --- 下标</span>
            <span class="post-date" title="2021-03-25 22:39:46">2021/03/25</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/2463101924.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 方法">Swift学习笔记 --- 方法</span>
            <span class="post-date" title="2021-03-25 21:02:24">2021/03/25</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1726206313.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 属性">Swift学习笔记 --- 属性</span>
            <span class="post-date" title="2021-03-24 22:35:53">2021/03/24</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1367898931.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 类和结构体">Swift学习笔记 --- 类和结构体</span>
            <span class="post-date" title="2021-03-24 21:07:01">2021/03/24</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1559514128.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 枚举">Swift学习笔记 --- 枚举</span>
            <span class="post-date" title="2021-03-24 19:22:11">2021/03/24</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/1519021199.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 闭包">Swift学习笔记 --- 闭包</span>
            <span class="post-date" title="2021-03-23 21:00:05">2021/03/23</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/383577965.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 函数">Swift学习笔记 --- 函数</span>
            <span class="post-date" title="2021-03-23 20:28:43">2021/03/23</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/2571907037.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 控制流">Swift学习笔记 --- 控制流</span>
            <span class="post-date" title="2021-03-22 22:33:12">2021/03/22</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3590693742.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 集合类型">Swift学习笔记 --- 集合类型</span>
            <span class="post-date" title="2021-03-22 20:09:01">2021/03/22</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3185683920.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 字符串和字符">Swift学习笔记 --- 字符串和字符</span>
            <span class="post-date" title="2021-03-21 23:12:47">2021/03/21</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/3538274255.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 基本运算符">Swift学习笔记 --- 基本运算符</span>
            <span class="post-date" title="2021-03-21 23:02:52">2021/03/21</span>
        </a>
        
        <a  class="全部笔记 iOS Swift-学习笔记 "
           href="/posts/2215211348.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Swift学习笔记 --- 基础部分">Swift学习笔记 --- 基础部分</span>
            <span class="post-date" title="2021-03-21 20:49:09">2021/03/21</span>
        </a>
        
        <a  class="全部笔记 工具 Jenkins "
           href="/posts/1870901654.html"
           data-tag="Jenkins"
           data-author="" >
            <span class="post-title" title="Jenkins --- iOS自动化打包">Jenkins --- iOS自动化打包</span>
            <span class="post-date" title="2021-03-19 20:36:33">2021/03/19</span>
        </a>
        
        <a  class="全部笔记 工具 Jenkins "
           href="/posts/210946848.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Jenkins --- 安装">Jenkins --- 安装</span>
            <span class="post-date" title="2021-03-19 19:36:17">2021/03/19</span>
        </a>
        
        <a  class="全部笔记 工具 Git "
           href="/posts/1519021198.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git --- 标签">Git --- 标签</span>
            <span class="post-date" title="2021-03-15 21:37:34">2021/03/15</span>
        </a>
        
        <a  class="全部笔记 工具 Git "
           href="/posts/1519021197.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git --- 分支">Git --- 分支</span>
            <span class="post-date" title="2021-03-15 21:34:56">2021/03/15</span>
        </a>
        
        <a  class="全部笔记 工具 Git "
           href="/posts/28b33e30.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git --- 基础">Git --- 基础</span>
            <span class="post-date" title="2021-03-10 23:16:21">2021/03/10</span>
        </a>
        
        <a  class="全部笔记 工具 Git "
           href="/posts/bcaee25f.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git --- 入门">Git --- 入门</span>
            <span class="post-date" title="2021-03-08 21:38:39">2021/03/08</span>
        </a>
        
        <a  class="全部笔记 工具 Hexo "
           href="/posts/2465856778.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo博客 --- 添加Gitalk评论">Hexo博客 --- 添加Gitalk评论</span>
            <span class="post-date" title="2021-03-07 23:16:11">2021/03/07</span>
        </a>
        
        <a  class="全部笔记 工具 Hexo "
           href="/posts/1bafec33.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo博客 --- 添加每日一言或诗词">Hexo博客 --- 添加每日一言或诗词</span>
            <span class="post-date" title="2021-03-07 23:15:11">2021/03/07</span>
        </a>
        
        <a  class="全部笔记 工具 Hexo "
           href="/posts/5d51cb1e.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo博客 --- 主题3-hexo">Hexo博客 --- 主题3-hexo</span>
            <span class="post-date" title="2021-03-07 23:14:22">2021/03/07</span>
        </a>
        
        <a  class="全部笔记 工具 Hexo "
           href="/posts/fcf4f4e7.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo博客 --- Markdown">Hexo博客 --- Markdown</span>
            <span class="post-date" title="2021-03-07 23:14:11">2021/03/07</span>
        </a>
        
        <a  class="全部笔记 工具 Hexo "
           href="/posts/2507c73c.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo博客 --- 写文章">Hexo博客 --- 写文章</span>
            <span class="post-date" title="2021-03-06 19:03:50">2021/03/06</span>
        </a>
        
        <a  class="全部笔记 工具 Hexo "
           href="/posts/5bd46458.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo博客 --- 环境搭建">Hexo博客 --- 环境搭建</span>
            <span class="post-date" title="2021-03-06 19:02:20">2021/03/06</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-iOS/Swift-学习笔记/Swift学习笔记-协议" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Swift学习笔记 --- 协议</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="iOS">iOS</a> > 
            
            <a  data-rel="iOS&lt;---&gt;Swift-学习笔记">Swift-学习笔记</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2021-03-28 20:43:49'>2021-03-28 17:11</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:5.2k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8D%8F%E8%AE%AE%E8%AF%AD%E6%B3%95"><span class="toc-text">1.协议语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%B1%9E%E6%80%A7%E8%A6%81%E6%B1%82"><span class="toc-text">2.属性要求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%96%B9%E6%B3%95%E8%A6%81%E6%B1%82"><span class="toc-text">3.方法要求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%BC%82%E5%8F%98%E6%96%B9%E6%B3%95%E8%A6%81%E6%B1%82"><span class="toc-text">4.异变方法要求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%9E%84%E9%80%A0%E5%99%A8%E8%A6%81%E6%B1%82"><span class="toc-text">5.构造器要求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%8D%8F%E8%AE%AE%E6%9E%84%E9%80%A0%E5%99%A8%E8%A6%81%E6%B1%82%E7%9A%84%E7%B1%BB%E5%AE%9E%E7%8E%B0"><span class="toc-text">5.1 协议构造器要求的类实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%8F%AF%E5%A4%B1%E8%B4%A5%E6%9E%84%E9%80%A0%E5%99%A8%E8%A6%81%E6%B1%82"><span class="toc-text">5.2 可失败构造器要求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%8D%8F%E8%AE%AE%E4%BD%9C%E4%B8%BA%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.协议作为类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%A7%94%E6%89%98"><span class="toc-text">7.委托</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%9C%A8%E6%89%A9%E5%B1%95%E9%87%8C%E6%B7%BB%E5%8A%A0%E5%8D%8F%E8%AE%AE%E9%81%B5%E5%BE%AA"><span class="toc-text">8.在扩展里添加协议遵循</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%9C%89%E6%9D%A1%E4%BB%B6%E5%9C%B0%E9%81%B5%E5%BE%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">9.有条件地遵循协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E5%9C%A8%E6%89%A9%E5%B1%95%E9%87%8C%E5%A3%B0%E6%98%8E%E9%87%87%E7%BA%B3%E5%8D%8F%E8%AE%AE"><span class="toc-text">10.在扩展里声明采纳协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E4%BD%BF%E7%94%A8%E5%90%88%E6%88%90%E5%AE%9E%E7%8E%B0%E6%9D%A5%E9%87%87%E7%BA%B3%E5%8D%8F%E8%AE%AE"><span class="toc-text">11.使用合成实现来采纳协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-Equatable"><span class="toc-text">11.1 Equatable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-Hashable"><span class="toc-text">11.2 Hashable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-Comparable"><span class="toc-text">11.3 Comparable</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%8D%8F%E8%AE%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%9B%86%E5%90%88"><span class="toc-text">12.协议类型的集合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-text">13.协议的继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E7%B1%BB%E4%B8%93%E5%B1%9E%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="toc-text">14.类专属的协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E5%8D%8F%E8%AE%AE%E5%90%88%E6%88%90"><span class="toc-text">15.协议合成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E6%A3%80%E6%9F%A5%E5%8D%8F%E8%AE%AE%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-text">16.检查协议一致性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-%E5%8F%AF%E9%80%89%E7%9A%84%E5%8D%8F%E8%AE%AE%E8%A6%81%E6%B1%82"><span class="toc-text">17.可选的协议要求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95"><span class="toc-text">18.协议扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#18-1-%E6%8F%90%E4%BE%9B%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0"><span class="toc-text">18.1 提供默认实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-2-%E4%B8%BA%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95%E6%B7%BB%E5%8A%A0%E9%99%90%E5%88%B6%E6%9D%A1%E4%BB%B6"><span class="toc-text">18.2 为协议扩展添加限制条件</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-6 i,
    .toc-level-6 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>关于<code>协议</code>：规定了用来实现某一特定任务或者功能的方法、属性，以及其他需要的东西。</p>
<p>关于遵循协议的类型：</p>
<ul>
<li>类、结构体或枚举都可以遵循协议</li>
<li>必须为协议定义的要求提供具体实现</li>
<li>可以对协议进行扩展，通过扩展来实现一部分要求或者实现一些附加功能</li>
</ul>
<h2 id="1-协议语法"><a href="#1-协议语法" class="headerlink" title="1.协议语法"></a>1.协议语法</h2><p>协议的定义方式与类、结构体和枚举的定义非常相似：</p>
<pre><code>protocol SomeProtocol &#123;
    // 这里是协议的定义部分
&#125;
</code></pre>
<p>自定义类型遵循某个协议，需要在类型名称后加上协议名称，中间以冒号（<code>:</code>）分隔。遵循多个协议时，各协议之间用逗号（<code>,</code>）分隔：</p>
<pre><code>struct SomeStructure: FirstProtocol, AnotherProtocol &#123;
    // 这里是结构体的定义部分
&#125;
</code></pre>
<p>若一个拥有父类的类在遵循协议时，应该<strong>将父类名放在协议名之前</strong>，以逗号分隔：</p>
<pre><code>class SomeClass: SomeSuperClass, FirstProtocol, AnotherProtocol &#123;
    // 这里是类的定义部分
&#125;
</code></pre>
<h2 id="2-属性要求"><a href="#2-属性要求" class="headerlink" title="2.属性要求"></a>2.属性要求</h2><p>协议可以要求遵循协议的类型提供特定名称和类型的实例属性或类型属性。</p>
<blockquote>
<p>注意：</p>
<ul>
<li>协议不指定属性是存储属性还是计算属性，它只指定属性的名称和类型</li>
<li>协议还指定属性是<code>可读</code>的还是<code>可读写</code>的</li>
<li>如果协议要求属性是可读可写的，那么该属性不能是常量属性或只读的计算型属性。如果协议只要求属性是可读的，那么该属性不仅可以是可读的，如果代码需要的话，还可以是可写的。</li>
</ul>
</blockquote>
<p>协议总是用 <code>var</code> 关键字来声明变量属性，在类型声明后加上 <code>&#123; set get &#125;</code> 来表示属性是可读可写的，可读属性则用 <code>&#123; get &#125;</code> 来表示：</p>
<pre><code>protocol SomeProtocol &#123;
    var mustBeSettable: Int &#123; get set &#125;
    var doesNotNeedToBeSettable: Int &#123; get &#125;
&#125;
</code></pre>
<p>在协议中定义类型属性时，使用 <code>static</code> 关键字作为前缀，当类类型遵循协议时，还可以使用 <code>class</code> 关键字来声明类型属性：</p>
<pre><code>protocol AnotherProtocol &#123;
    static var someTypeProperty: Int &#123; get set &#125;
&#125;
</code></pre>
<p>举例：只含有一个实例属性要求的协议，这个协议表示，任何遵循 <code>FullyNamed</code> 的类型，都必须有一个可读的 <code>String</code> 类型的实例属性 <code>fullName</code></p>
<pre><code>protocol FullyNamed &#123;
    var fullName: String &#123; get &#125;
&#125;
</code></pre>
<p>遵循 <code>FullyNamed</code> 协议的简单结构体：</p>
<pre><code>struct Person: FullyNamed &#123;
    var fullName: String
&#125;
let john = Person(fullName: &quot;John Appleseed&quot;)
// john.fullName 为 &quot;John Appleseed&quot;
</code></pre>
<p>遵循 <code>FullyNamed</code> 协议的复杂类：</p>
<pre><code>class Starship: FullyNamed &#123;
    var prefix: String?
    var name: String
    init(name: String, prefix: String? = nil) &#123;
        self.name = name
        self.prefix = prefix
    &#125;
    var fullName: String &#123;
        return (prefix != nil ? prefix! + &quot; &quot; : &quot;&quot;) + name
    &#125;
&#125;
var ncc1701 = Starship(name: &quot;Enterprise&quot;, prefix: &quot;USS&quot;)
// ncc1701.fullName 为 &quot;USS Enterprise&quot;
</code></pre>
<h2 id="3-方法要求"><a href="#3-方法要求" class="headerlink" title="3.方法要求"></a>3.方法要求</h2><p>协议可以要求遵循协议的类型实现某些指定的实例方法或类方法，这些方法：</p>
<ul>
<li>放在协议的定义中，但是不需要大括号和方法体</li>
<li>可以在协议中定义具有可变参数的方法，和普通方法的定义方式相同</li>
<li>不支持为协议中的方法提供默认参数</li>
</ul>
<p>在协议中定义方法，类方法用 <code>class</code> 或者 <code>static</code> 关键字:</p>
<pre><code>protocol SomeProtocol &#123;
    static func someTypeMethod()    
    func someInstanceMethod()
&#125;
</code></pre>
<p>举例：线性同余生成器（linear congruential generator） 的伪随机数算法：</p>
<pre><code>protocol RandomNumberGenerator &#123;
    func random() -&gt; Double
&#125;
class LinearCongruentialGenerator: RandomNumberGenerator &#123;
    var lastRandom = 42.0
    let m = 139968.0
    let a = 3877.0
    let c = 29573.0
    func random() -&gt; Double &#123;
        //truncatingRemainder 浮点数取余
        lastRandom = ((lastRandom * a + c).truncatingRemainder(dividingBy:m))
        return lastRandom / m
    &#125;
&#125;
</code></pre>
<h2 id="4-异变方法要求"><a href="#4-异变方法要求" class="headerlink" title="4.异变方法要求"></a>4.异变方法要求</h2><p>定义协议时在方法前加 <code>mutating</code> 关键字，表示该方法会改变遵循该协议的类型的实例：</p>
<pre><code>protocol Togglable &#123;
    mutating func toggle()
&#125;

enum OnOffSwitch: Togglable &#123;
    case off, on
    mutating func toggle() &#123;
        switch self &#123;
        case .off:
            self = .on
        case .on:
            self = .off
        &#125;
    &#125;
&#125;

var lightSwitch = OnOffSwitch.off
lightSwitch.toggle()
// lightSwitch 现在的值为 .on
</code></pre>
<blockquote>
<p>注意：实现协议中的 <code>mutating</code> 方法时，若是类类型，则不用写 <code>mutating</code> 关键字。而对于结构体和枚举，则必须写 <code>mutating</code> 关键字。</p>
</blockquote>
<h2 id="5-构造器要求"><a href="#5-构造器要求" class="headerlink" title="5.构造器要求"></a>5.构造器要求</h2><p>协议可以要求遵循协议的类型实现指定的构造器，你可以像编写普通构造器那样，在协议的定义里写下构造器的声明，但不需要写花括号和构造器的实体：</p>
<pre><code>protocol SomeProtocol &#123;
    init(someParameter: Int)
&#125;
</code></pre>
<h3 id="5-1-协议构造器要求的类实现"><a href="#5-1-协议构造器要求的类实现" class="headerlink" title="5.1 协议构造器要求的类实现"></a>5.1 协议构造器要求的类实现</h3><p>可以在遵循协议的类中实现构造器，无论是作为指定构造器，还是作为便利构造器。无论哪种情况，你都必须为构造器实现标上 <code>required</code> 修饰符：</p>
<pre><code>class SomeClass: SomeProtocol &#123;
    required init(someParameter: Int) &#123;
        // 这里是构造器的实现部分
    &#125;
&#125;
</code></pre>
<p>使用 <code>required</code> 修饰符可以确保所有子类也必须提供此构造器实现，从而也能符合协议。</p>
<blockquote>
<p>注意：如果类已经被标记为 <code>final</code>，那么不需要在协议构造器的实现中使用 <code>required</code> 修饰符，因为 <code>final</code> 类不能有子类。</p>
</blockquote>
<p>如果一个子类重写了父类的指定构造器，并且该构造器满足了某个协议的要求，那么该构造器的实现需要同时标注 <code>required</code> 和 <code>override</code> 修饰符：</p>
<pre><code>protocol SomeProtocol &#123;
    init()
&#125;

class SomeSuperClass &#123;
    init() &#123;
        // 这里是构造器的实现部分
    &#125;
&#125;

class SomeSubClass: SomeSuperClass, SomeProtocol &#123;
    // 因为遵循协议，需要加上 required
    // 因为继承自父类，需要加上 override
    required override init() &#123;
        // 这里是构造器的实现部分
    &#125;
&#125;
</code></pre>
<h3 id="5-2-可失败构造器要求"><a href="#5-2-可失败构造器要求" class="headerlink" title="5.2 可失败构造器要求"></a>5.2 可失败构造器要求</h3><p>协议还可以为遵循协议的类型定义可失败构造器要求</p>
<p>遵循协议的类型可以通过可失败构造器（<code>init?</code>）或非可失败构造器（<code>init</code>）来满足协议中定义的可失败构造器要求。协议中定义的非可失败构造器要求可以通过非可失败构造器（<code>init</code>）或隐式解包可失败构造器（<code>init!</code>）来满足。</p>
<h2 id="6-协议作为类型"><a href="#6-协议作为类型" class="headerlink" title="6.协议作为类型"></a>6.协议作为类型</h2><p>协议可以像其他普通类型一样使用，使用场景如下：</p>
<ul>
<li>作为函数、方法或构造器中的参数类型或返回值类型</li>
<li>作为常量、变量或属性的类型</li>
<li>作为数组、字典或其他容器中的元素类型</li>
</ul>
<p>下面是将协议作为类型使用的例子：</p>
<pre><code>class Dice &#123;
    let sides: Int
    let generator: RandomNumberGenerator
    init(sides: Int, generator: RandomNumberGenerator) &#123;
        self.sides = sides
        self.generator = generator
    &#125;
    func roll() -&gt; Int &#123;
        return Int(generator.random() * Double(sides)) + 1
    &#125;
&#125;
</code></pre>
<p><code>generator</code> 属性的类型为 <code>RandomNumberGenerator</code>，因此任何遵循了 <code>RandomNumberGenerator</code> 协议的类型的实例都可以赋值给 <code>generator</code>，除此之外并无其他要求。</p>
<pre><code>var d6 = Dice(sides: 6, generator: LinearCongruentialGenerator())
for _ in 1...5 &#123;
    print(&quot;Random dice roll is \(d6.roll())&quot;)
&#125;
// Random dice roll is 3
// Random dice roll is 5
// Random dice roll is 4
// Random dice roll is 5
// Random dice roll is 4
</code></pre>
<h2 id="7-委托"><a href="#7-委托" class="headerlink" title="7.委托"></a>7.委托</h2><p>委托是一种设计模式，它允许类或结构体将一些需要它们负责的功能委托给其他类型的实例。委托模式的实现很简单：<strong>定义协议来封装那些需要被委托的功能，这样就能确保遵循协议的类型能提供这些功能</strong>。委托模式可以用来响应特定的动作，或者接收外部数据源提供的数据，而无需关心外部数据源的类型。</p>
<p>下面的例子定义了两个基于骰子游戏的协议：</p>
<pre><code>protocol DiceGame &#123;
    var dice: Dice &#123; get &#125;
    func play()
&#125;
protocol DiceGameDelegate &#123;
    func gameDidStart(_ game: DiceGame)
    func game(_ game: DiceGame, didStartNewTurnWithDiceRoll diceRoll: Int)
    func gameDidEnd(_ game: DiceGame)
&#125;
</code></pre>
<p><a href="/posts/2571907037.html">控制流</a> 中蛇和梯子小游戏可以通过协议改写：</p>
<pre><code>class SnakesAndLadders: DiceGame &#123;
    let finalSquare = 25
    let dice = Dice(sides: 6, generator: LinearCongruentialGenerator())
    var square = 0
    var board: [Int]
    init() &#123;
        board = Array(repeating: 0, count: finalSquare + 1)
        board[03] = +08; board[06] = +11; board[09] = +09; board[10] = +02
        board[14] = -10; board[19] = -11; board[22] = -02; board[24] = -08
    &#125;
    var delegate: DiceGameDelegate?
    func play() &#123;
        square = 0
        delegate?.gameDidStart(self)
        gameLoop: while square != finalSquare &#123;
            let diceRoll = dice.roll()
            delegate?.game(self, didStartNewTurnWithDiceRoll: diceRoll)
            switch square + diceRoll &#123;
            case finalSquare:
                break gameLoop
            case let newSquare where newSquare &gt; finalSquare:
                continue gameLoop
            default:
                square += diceRoll
                square += board[square]
            &#125;
        &#125;
        delegate?.gameDidEnd(self)
    &#125;
&#125;

class DiceGameTracker: DiceGameDelegate &#123;
    var numberOfTurns = 0
    func gameDidStart(_ game: DiceGame) &#123;
        numberOfTurns = 0
        if game is SnakesAndLadders &#123;
            print(&quot;Started a new game of Snakes and Ladders&quot;)
        &#125;
        print(&quot;The game is using a \(game.dice.sides)-sided dice&quot;)
    &#125;
    func game(_ game: DiceGame, didStartNewTurnWithDiceRoll diceRoll: Int) &#123;
        numberOfTurns += 1
        print(&quot;Rolled a \(diceRoll)&quot;)
    &#125;
    func gameDidEnd(_ game: DiceGame) &#123;
        print(&quot;The game lasted for \(numberOfTurns) turns&quot;)
    &#125;
&#125;

let tracker = DiceGameTracker()
let game = SnakesAndLadders()
game.delegate = tracker
game.play()
// Started a new game of Snakes and Ladders
// The game is using a 6-sided dice
// Rolled a 3
// Rolled a 5
// Rolled a 4
// Rolled a 5
// The game lasted for 4 turns
</code></pre>
<h2 id="8-在扩展里添加协议遵循"><a href="#8-在扩展里添加协议遵循" class="headerlink" title="8.在扩展里添加协议遵循"></a>8.在扩展里添加协议遵循</h2><p>可以通过扩展令已有类型遵循并符合协议，通过扩展遵循协议，和在原始定义中遵循协议的效果完全相同。协议名称写在类型名之后，以冒号隔开，然后在扩展的大括号内实现协议要求的内容。</p>
<pre><code>protocol TextRepresentable &#123;
    var textualDescription: String &#123; get &#125;
&#125;
extension Dice: TextRepresentable &#123;
    var textualDescription: String &#123;
        return &quot;A \(sides)-sided dice&quot;
    &#125;
&#125;
let d12 = Dice(sides: 12, generator: LinearCongruentialGenerator())
print(d12.textualDescription)
// 打印 “A 12-sided dice”
</code></pre>
<h2 id="9-有条件地遵循协议"><a href="#9-有条件地遵循协议" class="headerlink" title="9.有条件地遵循协议"></a>9.有条件地遵循协议</h2><p>泛型类型可能只在某些情况下满足一个协议的要求，比如当类型的泛型形式参数遵循对应协议时。可以通过在扩展类型时列出限制让泛型类型有条件地遵循某协议，在你采纳协议的名字后面写泛型 <code>where</code> 分句：</p>
<pre><code>// 只要在存储遵循 TextRepresentable 协议的元素时就遵循 TextRepresentable 协议
extension Array: TextRepresentable where Element: TextRepresentable &#123;
    var textualDescription: String &#123;
        let itemsAsText = self.map &#123; $0.textualDescription &#125;
        return &quot;[&quot; + itemsAsText.joined(separator: &quot;, &quot;) + &quot;]&quot;
    &#125;
&#125;
let myDice = [d6, d12]
print(myDice.textualDescription)
// 打印 &quot;[A 6-sided dice, A 12-sided dice]&quot;
</code></pre>
<h2 id="10-在扩展里声明采纳协议"><a href="#10-在扩展里声明采纳协议" class="headerlink" title="10.在扩展里声明采纳协议"></a>10.在扩展里声明采纳协议</h2><p>当一个类型已经遵循了某个协议中的所有要求，却还没有声明采纳该协议时，可以通过空的扩展来让它采纳该协议：</p>
<pre><code>struct Hamster &#123;
    var name: String
       var textualDescription: String &#123;
        return &quot;A hamster named \(name)&quot;
    &#125;
&#125;
extension Hamster: TextRepresentable &#123;&#125; //Hamster 的实例可以作为 TextRepresentable 类型使用

let simonTheHamster = Hamster(name: &quot;Simon&quot;)
let somethingTextRepresentable: TextRepresentable = simonTheHamster
print(somethingTextRepresentable.textualDescription)
// 打印 “A hamster named Simon”
</code></pre>
<blockquote>
<p>即使满足了协议的所有要求，类型也不会自动遵循协议，必须显式地遵循协议。</p>
</blockquote>
<h2 id="11-使用合成实现来采纳协议"><a href="#11-使用合成实现来采纳协议" class="headerlink" title="11.使用合成实现来采纳协议"></a>11.使用合成实现来采纳协议</h2><p>Swift 可以自动提供一些简单场景下遵循 <code>Equatable</code>、<code>Hashable</code> 和 <code>Comparable</code> 协议的实现。在使用这些合成实现之后，无需再编写重复的代码来实现这些协议所要求的方法。</p>
<h3 id="11-1-Equatable"><a href="#11-1-Equatable" class="headerlink" title="11.1 Equatable"></a>11.1 Equatable</h3><p>Swift 为以下几种自定义类型提供了 <code>Equatable</code> 协议的合成实现：</p>
<ul>
<li>遵循 <code>Equatable</code> 协议且只有存储属性的结构体。</li>
<li>遵循 <code>Equatable</code> 协议且只有关联类型的枚举</li>
<li>没有任何关联类型的枚举</li>
</ul>
<p>在包含类型原始声明的文件中声明对 <code>Equatable</code> 协议的遵循，可以得到 <code>==</code> 操作符的合成实现，且无需自己编写任何关于 <code>==</code> 的实现代码。<code>Equatable</code> 协议同时包含 <code>!=</code> 操作符的默认实现。</p>
<pre><code>struct Vector3D: Equatable &#123;
    var x = 0.0, y = 0.0, z = 0.0
&#125;

let twoThreeFour = Vector3D(x: 2.0, y: 3.0, z: 4.0)
let anotherTwoThreeFour = Vector3D(x: 2.0, y: 3.0, z: 4.0)
if twoThreeFour == anotherTwoThreeFour &#123;
    print(&quot;These two vectors are also equivalent.&quot;)
&#125;
// 打印 &quot;These two vectors are also equivalent.&quot;
</code></pre>
<h3 id="11-2-Hashable"><a href="#11-2-Hashable" class="headerlink" title="11.2 Hashable"></a>11.2 Hashable</h3><p>Swift 为以下几种自定义类型提供了 <code>Hashable</code> 协议的合成实现：</p>
<ul>
<li>遵循 <code>Hashable</code> 协议且只有存储属性的结构体。</li>
<li>遵循 <code>Hashable</code> 协议且只有关联类型的枚举</li>
<li>没有任何关联类型的枚举</li>
</ul>
<p>在包含类型原始声明的文件中声明对 <code>Hashable</code> 协议的遵循，可以得到 <code>hash(into:)</code> 的合成实现，且无需自己编写任何关于 <code>hash(into:)</code> 的实现代码。</p>
<h3 id="11-3-Comparable"><a href="#11-3-Comparable" class="headerlink" title="11.3 Comparable"></a>11.3 Comparable</h3><p>Swift 为没有原始值的枚举类型提供了 <code>Comparable</code> 协议的合成实现。如果枚举类型包含关联类型，那这些关联类型也必须同时遵循 <code>Comparable</code> 协议。在包含原始枚举类型声明的文件中声明其对 <code>Comparable</code> 协议的遵循，可以得到 <code>&lt;</code> 操作符的合成实现，且无需自己编写任何关于 <code>&lt;</code> 的实现代码。<code>Comparable</code> 协议同时包含 <code>&lt;=</code>、<code>&gt;</code> 和 <code>&gt;=</code> 操作符的默认实现</p>
<pre><code>enum SkillLevel: Comparable &#123;
    case beginner
    case intermediate
    case expert(stars: Int)
&#125;
var levels = [SkillLevel.intermediate, SkillLevel.beginner,
              SkillLevel.expert(stars: 5), SkillLevel.expert(stars: 3)]
for level in levels.sorted() &#123;
    print(level)
&#125;
// 打印 &quot;beginner&quot;
// 打印 &quot;intermediate&quot;
// 打印 &quot;expert(stars: 3)&quot;
// 打印 &quot;expert(stars: 5)&quot;
</code></pre>
<h2 id="12-协议类型的集合"><a href="#12-协议类型的集合" class="headerlink" title="12.协议类型的集合"></a>12.协议类型的集合</h2><p>协议类型可以在数组或者字典这样的集合中使用:</p>
<pre><code>let things: [TextRepresentable] = [game, d12, simonTheHamster]
for thing in things &#123;
    print(thing.textualDescription)
&#125;
// A game of Snakes and Ladders with 25 squares
// A 12-sided dice
// A hamster named Simon
</code></pre>
<h2 id="13-协议的继承"><a href="#13-协议的继承" class="headerlink" title="13.协议的继承"></a>13.协议的继承</h2><p>协议能够继承一个或多个其他协议，可以在继承的协议的基础上增加新的要求。协议的继承语法与类的继承相似，多个被继承的协议间用逗号分隔：</p>
<pre><code>protocol InheritingProtocol: SomeProtocol, AnotherProtocol &#123;
    // 这里是协议的定义部分
&#125;
</code></pre>
<pre><code>protocol PrettyTextRepresentable: TextRepresentable &#123;
    var prettyTextualDescription: String &#123; get &#125;
&#125;
extension SnakesAndLadders: PrettyTextRepresentable &#123;
    var prettyTextualDescription: String &#123;
        var output = textualDescription + &quot;:\n&quot;
        for index in 1...finalSquare &#123;
            switch board[index] &#123;
            case let ladder where ladder &gt; 0:
                output += &quot;▲ &quot;
            case let snake where snake &lt; 0:
                output += &quot;▼ &quot;
            default:
                output += &quot;○ &quot;
            &#125;
        &#125;
        return output
    &#125;
&#125;
print(game.prettyTextualDescription)
// A game of Snakes and Ladders with 25 squares:
// ○ ○ ▲ ○ ○ ▲ ○ ○ ▲ ▲ ○ ○ ○ ▼ ○ ○ ○ ○ ▼ ○ ○ ▼ ○ ▼ ○
</code></pre>
<h2 id="14-类专属的协议"><a href="#14-类专属的协议" class="headerlink" title="14.类专属的协议"></a>14.类专属的协议</h2><p>添加 <code>AnyObject</code> 关键字到协议的继承列表，就可以限制协议只能被类类型采纳（以及非结构体或者非枚举的类型）</p>
<pre><code>protocol SomeClassOnlyProtocol: AnyObject, SomeInheritedProtocol &#123;
    // 这里是类专属协议的定义部分
&#125;
</code></pre>
<blockquote>
<p>当协议定义的要求需要遵循协议的类型必须是引用语义而非值语义时，应该采用类类型专属协议</p>
</blockquote>
<h2 id="15-协议合成"><a href="#15-协议合成" class="headerlink" title="15.协议合成"></a>15.协议合成</h2><p>一个类型同时遵循多个协议，可以使用 <code>SomeProtocol &amp; AnotherProtocol</code> 协议组合的形式，协议组合不定义任何新的协议类型</p>
<pre><code>protocol Named &#123;
    var name: String &#123; get &#125;
&#125;
protocol Aged &#123;
    var age: Int &#123; get &#125;
&#125;
struct Person: Named, Aged &#123;
    var name: String
    var age: Int
&#125;
func wishHappyBirthday(to celebrator: Named &amp; Aged) &#123;   //任何同时遵循 Named 和 Aged 的协议 即可
    print(&quot;Happy birthday, \(celebrator.name), you&#39;re \(celebrator.age)!&quot;)
&#125;
let birthdayPerson = Person(name: &quot;Malcolm&quot;, age: 21)
wishHappyBirthday(to: birthdayPerson)
// 打印 “Happy birthday Malcolm - you&#39;re 21!”
</code></pre>
<p>除了协议列表，协议组合也能包含类类型，这允许你标明一个需要的父类：</p>
<pre><code>class Location &#123;
    var latitude: Double
    var longitude: Double
    init(latitude: Double, longitude: Double) &#123;
        self.latitude = latitude
        self.longitude = longitude
    &#125;
&#125;
class City: Location, Named &#123;
    var name: String
    init(name: String, latitude: Double, longitude: Double) &#123;
        self.name = name
        super.init(latitude: latitude, longitude: longitude)
    &#125;
&#125;
func beginConcert(in location: Location &amp; Named) &#123;
    print(&quot;Hello, \(location.name)!&quot;)
&#125;

let seattle = City(name: &quot;Seattle&quot;, latitude: 47.6, longitude: -122.3)
beginConcert(in: seattle)
// 打印 &quot;Hello, Seattle!&quot;
</code></pre>
<h2 id="16-检查协议一致性"><a href="#16-检查协议一致性" class="headerlink" title="16.检查协议一致性"></a>16.检查协议一致性</h2><p>可以使用 <code>is</code> 和 <code>as</code> 操作符来检查协议一致性，即是否遵循某协议，并且可以转换到指定的协议类型。检查和转换协议的语法与检查和转换类型是完全一样的：</p>
<ul>
<li><code>is</code> 用来检查实例是否遵循某个协议，若遵循则返回 <code>true</code>，否则返回 <code>false</code>；</li>
<li><code>as?</code> 返回一个可选值，当实例遵循某个协议时，返回类型为协议类型的可选值，否则返回 <code>nil</code>；</li>
<li><code>as!</code> 将实例强制向下转换到某个协议类型，如果强转失败，将触发运行时错误。</li>
</ul>
<pre><code>protocol HasArea &#123;
    var area: Double &#123; get &#125;
&#125;

class Circle: HasArea &#123;
    let pi = 3.1415927
    var radius: Double
    var area: Double &#123; return pi * radius * radius &#125;
    init(radius: Double) &#123; self.radius = radius &#125;
&#125;
class Country: HasArea &#123;
    var area: Double
    init(area: Double) &#123; self.area = area &#125;
&#125;

class Animal &#123;
    var legs: Int
    init(legs: Int) &#123; self.legs = legs &#125;
&#125;

let objects: [AnyObject] = [
    Circle(radius: 2.0),
    Country(area: 243_610),
    Animal(legs: 4)
]

for object in objects &#123;
    if let objectWithArea = object as? HasArea &#123;
        print(&quot;Area is \(objectWithArea.area)&quot;)
    &#125; else &#123;
        print(&quot;Something that doesn&#39;t have an area&quot;)
    &#125;
&#125;
// Area is 12.5663708
// Area is 243610.0
// Something that doesn&#39;t have an area
</code></pre>
<h2 id="17-可选的协议要求"><a href="#17-可选的协议要求" class="headerlink" title="17.可选的协议要求"></a>17.可选的协议要求</h2><p>协议可以定义可选要求，遵循协议的类型可以选择是否实现这些要求。在协议中使用 <code>optional</code> 关键字作为前缀来定义可选要求。可选要求用在你需要和 Objective-C 打交道的代码中。协议和可选要求都必须带上 <code>@objc</code> 属性。标记 <code>@objc</code> 特性的协议只能被继承自 Objective-C 类的类或者 <code>@objc</code> 类遵循，其他类以及结构体和枚举均不能遵循这种协议。</p>
<p>使用可选要求时（例如，可选的方法或者属性），它们的类型会自动变成可选的。比如，一个类型为 <code>(Int) -&gt; String</code> 的方法会变成 <code>((Int) -&gt; String)?</code>。需要注意的是整个函数类型是可选的，而不是函数的返回值。</p>
<p>协议中的可选要求可通过可选链式调用来使用，因为遵循协议的类型可能没有实现这些可选要求</p>
<pre><code>@objc protocol CounterDataSource &#123;
    @objc optional func increment(forCount count: Int) -&gt; Int
    @objc optional var fixedIncrement: Int &#123; get &#125;
&#125;

class Counter &#123;
    var count = 0
    var dataSource: CounterDataSource?
    func increment() &#123;
        if let amount = dataSource?.increment?(forCount: count) &#123;
            count += amount
        &#125; else if let amount = dataSource?.fixedIncrement &#123;
            count += amount
        &#125;
    &#125;
&#125;
</code></pre>
<ul>
<li>遵循协议，实现可选属性：</li>
</ul>
<pre><code>class ThreeSource: NSObject, CounterDataSource &#123;
    let fixedIncrement = 3
&#125;
var counter = Counter()
counter.dataSource = ThreeSource()
for _ in 1...4 &#123;
    counter.increment()
    print(counter.count)
&#125;
// 3
// 6
// 9
// 12
</code></pre>
<ul>
<li>遵循协议，实现可选方法:</li>
</ul>
<pre><code>class TowardsZeroSource: NSObject, CounterDataSource &#123;
    func increment(forCount count: Int) -&gt; Int &#123;
        if count == 0 &#123;
            return 0
        &#125; else if count &lt; 0 &#123;
            return 1
        &#125; else &#123;
            return -1
        &#125;
    &#125;
&#125;
counter.count = -4
counter.dataSource = TowardsZeroSource()
for _ in 1...5 &#123;
    counter.increment()
    print(counter.count)
&#125;
// -3
// -2
// -1
// 0
// 0
</code></pre>
<h2 id="18-协议扩展"><a href="#18-协议扩展" class="headerlink" title="18.协议扩展"></a>18.协议扩展</h2><p>协议可以通过扩展来为遵循协议的类型提供属性、方法以及下标的实现。通过这种方式，你可以基于协议本身来实现这些功能，而无需在每个遵循协议的类型中都重复同样的实现，也无需使用全局函数。</p>
<pre><code>extension RandomNumberGenerator &#123;
    func randomBool() -&gt; Bool &#123;
        return random() &gt; 0.5
    &#125;
&#125;
</code></pre>
<p>通过协议扩展，所有遵循协议的类型，都能自动获得这个扩展所增加的方法实现而无需任何额外修改：</p>
<pre><code>let generator = LinearCongruentialGenerator()
print(&quot;Here&#39;s a random number: \(generator.random())&quot;)
// 打印 “Here&#39;s a random number: 0.37464991998171”
print(&quot;And here&#39;s a random Boolean: \(generator.randomBool())&quot;)
// 打印 “And here&#39;s a random Boolean: true”
</code></pre>
<p>协议扩展可以为遵循协议的类型增加实现，但不能声明该协议继承自另一个协议。协议的继承只能在协议声明处进行指定。</p>
<h3 id="18-1-提供默认实现"><a href="#18-1-提供默认实现" class="headerlink" title="18.1 提供默认实现"></a>18.1 提供默认实现</h3><p>可以通过协议扩展来为协议要求的方法、计算属性提供默认的实现。如果遵循协议的类型为这些要求提供了自己的实现，那么这些自定义实现将会替代扩展中的默认实现被使用。</p>
<blockquote>
<p>通过协议扩展为协议要求提供的默认实现和可选的协议要求不同。虽然在这两种情况下，遵循协议的类型都无需自己实现这些要求，但是通过扩展提供的默认实现可以直接调用，而无需使用可选链式调用。</p>
</blockquote>
<pre><code>extension PrettyTextRepresentable  &#123;
    var prettyTextualDescription: String &#123;
        return textualDescription
    &#125;
&#125;
</code></pre>
<h3 id="18-2-为协议扩展添加限制条件"><a href="#18-2-为协议扩展添加限制条件" class="headerlink" title="18.2 为协议扩展添加限制条件"></a>18.2 为协议扩展添加限制条件</h3><p>在扩展协议的时候，可以指定一些限制条件，只有遵循协议的类型满足这些限制条件时，才能获得协议扩展提供的默认实现。这些限制条件写在协议名之后，使用 <code>where</code> 子句来描述:</p>
<pre><code>// 扩展 Collection 协议，适用于集合中的元素遵循了 Equatable 协议的情况。
// 通过限制集合元素遵循 Equatable 协议， 作为标准库的一部分， 你可以使用 == 和 != 操作符来检查两个元素的等价性和非等价性
extension Collection where Element: Equatable &#123;
    func allEqual() -&gt; Bool &#123;
        for element in self &#123;
            if element != self.first &#123;
                return false
            &#125;
        &#125;
        return true
    &#125;
&#125;
let equalNumbers = [100, 100, 100, 100, 100]
let differentNumbers = [100, 100, 200, 100, 200]
print(equalNumbers.allEqual())
// 打印 &quot;true&quot;
print(differentNumbers.allEqual())
// 打印 &quot;false&quot;
</code></pre>
<blockquote>
<p>如果一个遵循的类型满足了为同一方法或属性提供实现的多个限制型扩展的要求， Swift 会使用最匹配限制的实现。</p>
</blockquote>

      
       
    </div>
</article>

<div class="article_copyright">
    <span class="copy-title">本文作者:</span><a  title="Rui">Rui</a></br>
    <span class="copy-title">发布时间:</span>2021-03-28, 17:11:37</br>
    <!-- <span class="copy-title">最后更新:</span>2021-03-28, 20:43:49</br> -->
    <span class="copy-title">原始链接:</span><a class="post-url" href="/posts/2463246486.html" title="Swift学习笔记 --- 协议">https://wrf8.github.io/posts/2463246486.html</a></br>
    <span class="copy-title">版权声明:</span>转载请保留原文链接及作者。
</div>



    <p>
        <a  class="dashang" onclick="dashangToggle()">赏</a>
    </p>


    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'd0adb2c4a85ac6aba8a9',
            clientSecret: 'af57644505292c56d19c67542c250c5b1a33beb2',
            repo: 'gitalk',
            owner: 'wrf8',
            admin: ['wrf8'],
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>



    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2021
</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 527px;
        }
        .nav.fullscreen {
            margin-left: -527px;
        }
        .nav-left {
            width: 135px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 527px;
            margin-left: -527px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
